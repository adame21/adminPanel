(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{12:function(e,t,a){e.exports=a(21)},18:function(e,t,a){},20:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(11),s=a.n(l),c=(a(17),a(18),a(3)),i=a(4),u=a(6),o=a(5),h=a(1),d=a(7),m=a(2),p=a.n(m),b=a(8),g=a(9),E=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(o.a)(t).call(this,e))).state={userName:"admin",password:"admin"},a.handleChange=a.handleChange.bind(Object(h.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(h.a)(a)),a.handleReset=a.handleReset.bind(Object(h.a)(a)),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){this.setState(Object(g.a)({},e.target.name,e.target.value))}},{key:"handleSubmit",value:function(){var e=Object(b.a)(p.a.mark((function e(t){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,fetch("http://localhost:3005/login",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({userName:this.state.userName,password:this.state.password})});case 4:return a=e.sent,e.next=7,a.json();case 7:n=e.sent,this.props.changePage(n.page),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log("err: "+e.t0.message);case 14:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleReset",value:function(){this.setState({userName:"",password:""})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",{className:"text-primary"},"Login"),r.a.createElement("label",null,"Username:"),r.a.createElement("input",{type:"text",value:this.state.userName,onChange:this.handleChange,name:"userName"}),r.a.createElement("br",null),r.a.createElement("label",null,"Password:"),r.a.createElement("input",{type:"password",value:this.state.password,onChange:this.handleChange,name:"password"}),r.a.createElement("br",null),r.a.createElement("button",{className:"btn-primary",onClick:this.handleSubmit},"Login"),r.a.createElement("button",{className:"btn-secondary",onClick:this.handleReset},"Reset"))}}]),t}(r.a.Component),f=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(o.a)(t).call(this,e))).state={packages:[],agencies:[],agencyName:"",website:"",phone:"",package:0,subscription:a.getTime(),page:"default",editObj:{},editMode:!1},a.handleChange=a.handleChange.bind(Object(h.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(h.a)(a)),a.handleReset=a.handleReset.bind(Object(h.a)(a)),a.handleReturn=a.handleReturn.bind(Object(h.a)(a)),a.handleDelete=a.handleDelete.bind(Object(h.a)(a)),a.handleEdit=a.handleEdit.bind(Object(h.a)(a)),a.saveChanges=a.saveChanges.bind(Object(h.a)(a)),a.discardChanges=a.discardChanges.bind(Object(h.a)(a)),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getTime",value:function(){var e=(new Date).toLocaleDateString();return"".concat(e.slice(5),"-").concat(1==e.slice(0,1).length?"0"+e.slice(0,1):e.slice(0,1),"-").concat(1==e.slice(2,4).length?"0"+e.slice(2,4):e.slice(2,4))}},{key:"componentDidMount",value:function(){var e=Object(b.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.loadArrays();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadArrays",value:function(){var e=Object(b.a)(p.a.mark((function e(){var t,a,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:3005/select/packages",{method:"get"});case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,e.next=8,fetch("http://localhost:3005/select/agencies",{method:"get"});case 8:return n=e.sent,e.next=11,n.json();case 11:r=e.sent,this.setState({packages:a,agencies:r,package:a[0]?a[0].id:0});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleChange",value:function(e){this.setState(Object(g.a)({},e.target.name,e.target.value))}},{key:"handleSubmit",value:function(){var e=Object(b.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this.validateState(this.state)){e.next=18;break}return e.prev=2,e.next=5,fetch("http://localhost:3005/add/agencies",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.state)});case 5:return a=e.sent,e.next=8,a.json();case 8:e.sent,this.setState({page:"added"}),this.loadArrays(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),console.log("err: "+e.t0.message,"stack: "+e.t0.stack);case 16:e.next=19;break;case 18:alert("missing input");case 19:case"end":return e.stop()}}),e,this,[[2,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleDelete",value:function(){var e=Object(b.a)(p.a.mark((function e(t){var a,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete?")){e.next=13;break}return a=t.target.parentElement.parentElement.firstElementChild.innerHTML,e.next=5,fetch("http://localhost:3005/delete/agencies",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a})});case 5:return n=e.sent,e.next=8,n.json();case 8:r=e.sent,this.loadArrays(),console.log(r),e.next=14;break;case 13:console.log("no delete");case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleEdit",value:function(e){var t=e.target.parentElement.parentElement.childNodes[0].innerHTML,a=e.target.parentElement.parentElement.childNodes[1].innerHTML,n=e.target.parentElement.parentElement.childNodes[2].innerHTML,r=e.target.parentElement.parentElement.childNodes[3].innerHTML,l=e.target.parentElement.parentElement.childNodes[4].innerHTML,s=e.target.parentElement.parentElement.childNodes[5].innerHTML;this.setState({agencyName:a,website:n,phone:r,packageId:l,subscription:s,editObj:{agencyName:a,website:n,phone:r,packageId:l,subscription:s,id:t},editMode:!0})}},{key:"saveChanges",value:function(){var e=Object(b.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(this.state.editObj),this.setState({editObj:{agencyName:this.state.agencyName,website:this.state.website,phone:this.state.phone,package:this.state.package,subscription:this.state.subscription}}),console.log(this.state.editObj),e.next=5,fetch("http://localhost:3005/update/agencies",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.state.editObj)});case 5:return t=e.sent,e.next=8,t.json;case 8:e.sent,console.log(this.state.editObj);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"discardChanges",value:function(){}},{key:"validateState",value:function(e){return!!(e.agencyName&&e.website&&e.phone&&e.package&&e.subscription)}},{key:"handleReset",value:function(){this.setState({agencyName:"",website:"",phone:"",package:"",subscription:new Date})}},{key:"handleReturn",value:function(){this.setState({page:"default"})}},{key:"renderAdded",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Added successfuly!"),r.a.createElement("br",null),r.a.createElement("button",{className:"btn btn-info",onClick:this.handleReturn},"Return"))}},{key:"renderButtons",value:function(){return this.state.editMode?r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-success",onClick:this.saveChanges},"Save"),r.a.createElement("button",{className:"btn btn-warning",onClick:this.discardChanges},"Cancel")):r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-primary",onClick:this.handleSubmit},"Add"),r.a.createElement("button",{className:"btn btn-secondary",onClick:this.handleReset},"Reset"))}},{key:"render",value:function(){var e=this;return"added"==this.state.page?this.renderAdded():r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-warning",onClick:function(){return e.props.changePage("default")}},"Return"),r.a.createElement("h1",{className:"text-primary"},"Agencies Panel"),r.a.createElement("label",null,"Add agency"),r.a.createElement("br",null),r.a.createElement("label",null,"Agency name"),r.a.createElement("input",{type:"text",name:"agencyName",value:this.state.agencyName,onChange:this.handleChange}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("label",null,"Website"),r.a.createElement("input",{type:"text",name:"website",value:this.state.website,onChange:this.handleChange}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("label",null,"Phone"),r.a.createElement("input",{type:"text",name:"phone",value:this.state.phone,onChange:this.handleChange}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("label",null,"Package"),r.a.createElement("br",null),r.a.createElement("select",{name:"package",id:"package",onChange:this.handleChange,defaultValue:this.state.packages[0]},this.state.packages.map((function(e,t){return r.a.createElement("option",{key:e.id,id:e.id,value:e.id},e.id,e.name," - ",e.no_of_agents," agents -"," ",e.no_of_documents," documents")}))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("label",null,"Subscription"),r.a.createElement("input",{type:"date",name:"subscription",value:this.state.subscription,onChange:this.handleChange}),r.a.createElement("br",null),r.a.createElement("br",null),this.renderButtons(),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col",key:"1"},"#"),r.a.createElement("th",{scope:"col",key:"2"},"Name"),r.a.createElement("th",{scope:"col",key:"3"},"Website"),r.a.createElement("th",{scope:"col",key:"4"},"Phone"),r.a.createElement("th",{scope:"col",key:"5"},"Package"),r.a.createElement("th",{scope:"col",key:"6"},"Subscription"),r.a.createElement("th",{scope:"col",key:"7"},"Last Created"),r.a.createElement("th",{scope:"col",key:"8"},"Last Updated"),r.a.createElement("th",{scope:"col",key:"9"},"Controls"))),r.a.createElement("tbody",null,this.state.agencies.map((function(t){return r.a.createElement("tr",{key:t.id},r.a.createElement("th",{scope:"row",key:t.id},t.id),r.a.createElement("td",null,t.name),r.a.createElement("td",null,t.web_site),r.a.createElement("td",null,t.phone),r.a.createElement("td",null,t.package_id),r.a.createElement("td",null,t.subscription_end_date.substring(0,10)),r.a.createElement("td",null,t.created_at.substring(0,10)),r.a.createElement("td",null,t.updated_at.substring(0,10)),r.a.createElement("td",null," ",r.a.createElement("button",{className:"btn btn-danger",onClick:e.handleDelete},"Delete")),r.a.createElement("td",null," ",r.a.createElement("button",{className:"btn btn-warning",onClick:e.handleEdit},"Edit")))})))))}}]),t}(r.a.Component),y=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(o.a)(t).call(this,e))).state={page:"default"},a.handleClick=a.handleClick.bind(Object(h.a)(a)),a.changePage=a.changePage.bind(Object(h.a)(a)),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"handleClick",value:function(e){this.changePage(e)}},{key:"changePage",value:function(e){this.setState({page:e})}},{key:"renderAgencies",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(f,{changePage:this.changePage}))}},{key:"renderAgents",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"hi"))}},{key:"render",value:function(){var e=this;switch(this.state.page){case"agencies":return this.renderAgencies();case"agents":return this.renderAgents();default:return r.a.createElement("div",null,r.a.createElement("h1",{className:"text-primary"},"Home"),r.a.createElement("label",null,"Select:"),r.a.createElement("br",null),r.a.createElement("button",{className:"btn-primary",value:"agencies",onClick:function(){return e.handleClick("agencies")}},"Agencies"),r.a.createElement("button",{className:"btn-primary",value:"agents",onClick:function(){return e.handleClick("agents")}},"Agents"))}}}]),t}(r.a.Component),k=(a(20),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(o.a)(t).call(this,e))).state={page:"login"},a.changePage=a.changePage.bind(Object(h.a)(a)),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"changePage",value:function(e){this.setState({page:e})}},{key:"renderLogin",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(E,{changePage:this.changePage}))}},{key:"renderHome",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(y,{changePage:this.changePage}))}},{key:"render",value:function(){switch(this.state.page){case"login":return this.renderLogin();case"home":return this.renderHome();default:return this.renderLogin()}}}]),t}(r.a.Component));s.a.render(r.a.createElement(k,null),document.getElementById("root"))}},[[12,1,2]]]);
//# sourceMappingURL=main.c6855a1f.chunk.js.map